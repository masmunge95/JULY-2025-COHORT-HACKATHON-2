# Full-Stack Educational Assistant

This project is a complete web-based educational assistant designed to help users learn new topics through AI-generated quizzes and flashcards. It features a Python FastAPI backend, a vanilla JavaScript frontend, user authentication via Supabase, and payment integration with InstaSend.

## Features

- **User Authentication**: Secure sign-up, login, and session management with Supabase Auth.
- **AI-Powered Content**: Generate quizzes and flashcards on any topic using the Hugging Face Inference API.
- **Interactive Learning**:
  - **Quizzes**: Multiple-choice questions with instant feedback and score tracking.
  - **Flashcards**: Flip-card interface to study concepts.
- **Progress Tracking**: View your learning history and milestones on the dashboard.
- **Premium Features**: Unlock unlimited content generation via a secure checkout flow with InstaSend.
- **Secure by Design**: Uses Supabase's Row Level Security (RLS) to ensure users can only access their own data.

## Tech Stack

- **Frontend**: HTML, TailwindCSS (via CDN), Vanilla JavaScript
- **Backend**: Python, FastAPI
- **Database & Auth**: Supabase (PostgreSQL)
- **AI Model**: Hugging Face Inference API (e.g., `google/flan-t5-base`)
- **Payments**: InstaSend API

---

## Setup Instructions

Follow these steps to get the project running locally.

### 1. Prerequisites

- Python 3.8+ and `pip`
- A code editor (e.g., VS Code)
- A web browser

### 2. API Keys and Environment Variables

You will need the following API keys from these free services:

- **Supabase**:
  1. Go to supabase.com and create a new project.
  2. In your project, go to **Project Settings > API**.
  3. Find your **Project URL** (`SUPABASE_URL`) and `anon` **public key** (`SUPABASE_KEY`).
  4. You will also need the `service_role` key for the backend. Find it under **Project Settings > API > Project API keys**.

- **Hugging Face**:
  1. Go to huggingface.co and create an account.
  2. Go to your **Profile > Settings > Access Tokens**.
  3. Create a new token (`HF_API_KEY`).

- **InstaSend**:
  1. Go to instasend.com and create an account.
  2. In your dashboard, find your **API Key** (`INSTASEND_API_KEY`) and **Wallet ID** (`INSTASEND_WALLET_ID`).

### 3. Supabase Database Setup

1. In your Supabase project, go to the **SQL Editor**.
2. Click **+ New query**.
3. Copy the entire content of `supabase_schema.sql` (provided below) and paste it into the editor.
4. Click **RUN**. This will create the necessary tables (`profiles`, `history`, `milestones`, `payments`) and enable Row Level Security policies.

<details>
<summary>Click to expand `supabase_schema.sql`</summary>

```sql
-- 1. PROFILES TABLE
-- This table stores public user data.
create table profiles (
  id uuid references auth.users on delete cascade not null primary key,
  updated_at timestamp with time zone,
  email text unique,
  is_premium boolean default false
);

-- Set up Row Level Security (RLS)
alter table profiles enable row level security;

create policy "Public profiles are viewable by everyone."
  on profiles for select using (true);

create policy "Users can insert their own profile."
  on profiles for insert with check (auth.uid() = id);

create policy "Users can update their own profile."
  on profiles for update using (auth.uid() = id);

-- This trigger automatically creates a profile entry when a new user signs up.
create function public.handle_new_user()
returns trigger as $$
begin
  insert into public.profiles (id, email)
  values (new.id, new.email);
  return new;
end;
$$ language plpgsql security definer;

create trigger on_auth_user_created
  after insert on auth.users
  for each row execute procedure public.handle_new_user();

-- 2. HISTORY TABLE
-- Stores records of quizzes and flashcards generated.
create table history (
  id bigint generated by default as identity primary key,
  user_id uuid references auth.users on delete cascade not null,
  created_at timestamp with time zone default now(),
  topic text not null,
  activity_type text not null, -- 'quiz' or 'flashcard'
  score integer -- Only for quizzes
);

alter table history enable row level security;
create policy "Users can view their own history." on history for select using (auth.uid() = user_id);
create policy "Users can insert their own history." on history for insert with check (auth.uid() = user_id);

-- 3. MILESTONES TABLE
-- Stores user achievements.
create table milestones (
  id bigint generated by default as identity primary key,
  user_id uuid references auth.users on delete cascade not null,
  created_at timestamp with time zone default now(),
  milestone_name text not null,
  description text
);

alter table milestones enable row level security;
create policy "Users can view their own milestones." on milestones for select using (auth.uid() = user_id);
create policy "Users can insert their own milestones." on milestones for insert with check (auth.uid() = user_id);

-- 4. PAYMENTS TABLE
-- Stores payment records from InstaSend.
create table payments (
  id bigint generated by default as identity primary key,
  user_id uuid references auth.users on delete cascade not null,
  created_at timestamp with time zone default now(),
  instasend_payment_id text unique not null,
  amount numeric(10, 2) not null,
  currency text not null
);

alter table payments enable row level security;
create policy "Users can view their own payments." on payments for select using (auth.uid() = user_id);
-- IMPORTANT: Only the backend (using service_role key) should be able to insert into this table.
-- RLS for insert is intentionally omitted for user roles.
```
</details>

### 4. Backend Setup

1.  Navigate to the `backend` directory: `cd backend`
2.  Create a `.env` file by copying the example: `cp .env.example .env`
3.  Edit `.env` and fill in your secret keys:
    ```
    SUPABASE_URL="YOUR_SUPABASE_URL"
    SUPABASE_SERVICE_KEY="YOUR_SUPABASE_SERVICE_ROLE_KEY"
    HF_API_KEY="YOUR_HUGGING_FACE_API_KEY"
    INSTASEND_API_KEY="YOUR_INSTASEND_API_KEY"
    INSTASEND_WALLET_ID="YOUR_INSTASEND_WALLET_ID"
    # The URL where your frontend is running, for CORS
    FRONTEND_URL="http://127.0.0.1:5500"
    ```
4.  Install dependencies: `pip install -r requirements.txt`
5.  Start the server: `uvicorn main:app --reload`

The backend will be running at `http://127.0.0.1:8000`.

### 5. Frontend Setup

1.  The frontend needs to know your public Supabase credentials. **There is no `.env` file for the frontend.** You must edit `frontend/js/auth.js` directly.

    Open `frontend/js/auth.js` and replace the placeholder values at the top of the file:
    ```javascript
    const SUPABASE_URL = 'YOUR_SUPABASE_URL';
    const SUPABASE_KEY = 'YOUR_SUPABASE_ANON_PUBLIC_KEY';
    ```
2.  You can run the frontend using a simple live server. If you have VS Code, you can use the "Live Server" extension.
    - Right-click on `frontend/index.html` and select "Open with Live Server".
    - This will typically open the site at `http://127.0.0.1:5500`. Make sure this address matches `FRONTEND_URL` in your backend's `.env` file.

### 6. Deployment

#### Backend (Render)

1.  Push your code to a GitHub repository.
2.  Go to render.com and create a new "Web Service".
3.  Connect your GitHub repository.
4.  Settings:
    - **Build Command**: `pip install -r requirements.txt`
    - **Start Command**: `uvicorn main:app --host 0.0.0.0 --port $PORT`
5.  Under "Environment", add all the variables from your `.env` file.
    - **Important**: Update `FRONTEND_URL` to your deployed frontend URL (e.g., from Netlify).

#### Frontend (Netlify)

1.  Push your code to a GitHub repository (can be the same one).
2.  Go to netlify.com and create a new site from Git.
3.  Connect your GitHub repository.
4.  Settings:
    - **Base directory**: `frontend`
    - **Build command**: (leave blank)
    - **Publish directory**: `frontend`
5.  Deploy the site. Netlify will give you a public URL.
6.  **Remember to update the `FRONTEND_URL` environment variable in your Render backend service to this new Netlify URL.**